<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troubleshooting - Slack AI Agent Bot</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîß Troubleshooting</h1>
            <p>Common issues and the fastest fixes</p>
        </header>

        <nav class="breadcrumb">
            <a href="index.html">‚Üê Back to Home</a>
        </nav>

        <div class="success-box">
            <h3>Latest Fixes (Nov 12, 2025)</h3>
            <ul>
                <li>‚úÖ Screen bridge now sends a true Enter keypress, so the agent actually replies.</li>
                <li>‚úÖ `pull`/`show` accept custom line counts (`pull 200`, `show 250`, etc.).</li>
                <li>‚úÖ Docs + `init.sh` document the ‚Äúsend ‚Üí wait ‚Üí pull or show‚Äù workflow.</li>
            </ul>
        </div>

        <div class="error-box">
            <h2>Problem: <code>pull</code>/<code>show</code> only shows UI text</h2>
            <ul>
                <li>Wait another second or two and rerun <code>pull 200</code> or <code>show 200</code>.</li>
                <li>If still blank, attach via <code>screen -r slack-claude</code> to verify the CLI is running.</li>
                <li>Make sure someone ran <code>./init.sh start</code> after reboot so the bridge + screen are in sync.</li>
            </ul>
            <p>The bridge already presses Enter for you, so once the agent finishes thinking its reply will appear in the log.</p>
        </div>

        <div class="error-box">
            <h2>Problem: <code>pull</code>/<code>show</code> says ‚Äúlog missing‚Äù</h2>
            <p>The screen session wasn‚Äôt started with logging enabled.</p>
            <ol>
                <li>Run <code>./init.sh screen</code> (or use the manual screen command).</li>
                <li>Retest with <code>pull 80</code> or <code>show 50</code>.</li>
            </ol>
        </div>

        <div class="error-box">
            <h2>Problem: `/agent` slash command error</h2>
            <p>Register `/agent` in Slack ‚Üí App settings ‚Üí Slash Commands. Until then, type commands as plain messages (e.g., `agent status`).</p>
            <p><a href="slash-commands.html" class="button">Slash Command Setup ‚Üí</a></p>
        </div>

        <div class="error-box">
            <h2>Problem: Bot looks offline / grey dot</h2>
            <p>Tokens are usually wrong. Confirm <code>SLACK_BOT_TOKEN</code> starts with <code>xoxb-</code> and <code>SLACK_APP_TOKEN</code> starts with <code>xapp-</code> in <code>.env</code>, then <code>sudo systemctl restart slack-claude-bot</code>.</p>
        </div>

        <div class="error-box">
            <h2>Problem: Need to stop a long-running operation</h2>
            <p>Run <code>/agent stop</code> (or `/agent cancel` / `/agent abort`) to send Ctrl+C to the bridge. You can also attach to the screen session and press Ctrl+C manually.</p>
        </div>

        <div class="card">
            <h2>Diagnostic Commands</h2>
            <pre><code>screen -ls                    # is slack-claude running?
tail -40 logs/claude_screen.log # last agent output
sudo systemctl status slack-claude-bot
sudo journalctl -u slack-claude-bot -n 40</code></pre>
        </div>

        <div class="card">
            <h2>Still stuck?</h2>
            <ul>
                <li>Re-run <code>./init.sh start</code> to reset everything.</li>
                <li>Review <code>/home/appsforte/slackaiagent/AGENTS.md</code> for the full runbook.</li>
                <li>Ping the on-call operator with the output of <code>./init.sh test</code>.</li>
            </ul>
        </div>

        <div class="footer">
            <p><a href="index.html">‚Üê Back to Home</a></p>
        </div>
    </div>
</body>
</html>
